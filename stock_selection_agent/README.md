# Stock Selection Agent System

## 개요

탑 레벨 펀드매니저의 종목 선정 프로세스를 자동화하는 멀티 에이전트 시스템입니다. KOSPI 및 글로벌 주식 시장에서 투자 종목을 선별하기 위한 체계적인 밸류에이션과 분석을 수행합니다.

## 페르소나

> 글로벌 자산운용사의 수석 펀드매니저 겸 퀀트 애널리스트
> - 10년 이상의 한국/아시아 주식 운용 경험
> - CFA, FRM 자격 보유
> - Bottom-up 기업 분석과 Top-down 매크로 분석의 통합 역량

## 핵심 목표

1. **퀀트 스크리닝**: 수천 개 종목에서 투자 후보군 100개 이내로 축소
2. **펀더멘털 분석**: 재무제표 기반 기업 건전성 및 수익성 평가
3. **밸류에이션**: DCF, Relative Valuation을 통한 내재가치 산출
4. **리스크 평가**: 변동성, 상관관계, 유동성 리스크 분석
5. **최종 포트폴리오**: 상위 20~30개 확신주(High Conviction) 선정

## ⚠️ 필수 요구사항: 날짜 확인 (Date Validation)

**모든 분석 시작 전 반드시 현재 날짜를 확인해야 합니다.**

### 왜 중요한가?
- 재무 데이터 검색 시 올바른 연도를 사용해야 최신 데이터 확보 가능
- 실적 전망(Forward Looking)과 과거 실적(Historical) 구분에 필수
- 분기별 실적 발표 일정에 따른 데이터 가용성 판단에 필요
- 애널리스트 목표주가/컨센서스의 유효성 검증에 필수

### 날짜 확인 프로세스
```
┌─────────────────────────────────────────────────────────────┐
│                    분석 시작 전 체크리스트                    │
├─────────────────────────────────────────────────────────────┤
│ 1. 현재 날짜 확인 (시스템 날짜 또는 사용자 확인)               │
│ 2. 분석 기준일 설정 (analysis_date)                          │
│ 3. 데이터 검색 시 올바른 연도 키워드 사용                      │
│    예: "삼성전자 실적 2026년 1분기" (X) "삼성전자 실적 2025년" │
│ 4. 과거/미래 데이터 구분                                     │
│    - 과거: 확정 실적 (Actual)                                │
│    - 미래: 추정 실적 (Estimate/Forecast)                     │
│ 5. 최종 리포트에 분석 기준일 명시                             │
└─────────────────────────────────────────────────────────────┘
```

### 설정 파일 참조
- `config/workflow.yaml`: `date_validation` 섹션
- 각 에이전트 INSTRUCTIONS.md: `## 0. 날짜 확인 (필수)` 섹션

### 날짜 관련 컨텍스트 변수
| 변수명 | 설명 | 예시 |
|--------|------|------|
| `current_date` | 분석 기준일 | 2026-02-01 |
| `current_year` | 현재 연도 | 2026 |
| `current_quarter` | 현재 분기 | Q1 |
| `historical_start` | 과거 데이터 시작 연도 | 2021 |
| `forecast_end` | 전망 데이터 종료 연도 | 2028 |
| `latest_reported_quarter` | 최근 확정 실적 분기 | 2025 Q4 |

## 프로젝트 구조

```
stock_selection_agent/
├── README.md                              # 프로젝트 개요
├── config/
│   └── workflow.yaml                      # 워크플로우 설정
├── agents/
│   ├── 00_master_orchestrator/            # 마스터 에이전트 (오케스트레이터)
│   │   └── INSTRUCTIONS.md
│   ├── 01_screening_agent/                # 1단계: 퀀트 스크리닝
│   │   └── INSTRUCTIONS.md
│   ├── 02_financial_agent/                # 2단계: 재무제표 분석
│   │   └── INSTRUCTIONS.md
│   ├── 03_industry_agent/                 # 3단계: 산업 분석
│   │   └── INSTRUCTIONS.md
│   ├── 04_dcf_valuation_agent/            # 4단계: DCF 밸류에이션
│   │   └── INSTRUCTIONS.md
│   ├── 05_relative_valuation_agent/       # 5단계: 상대가치 평가
│   │   └── INSTRUCTIONS.md
│   ├── 06_technical_agent/                # 6단계: 기술적 분석
│   │   └── INSTRUCTIONS.md
│   ├── 07_risk_agent/                     # 7단계: 리스크 분석
│   │   └── INSTRUCTIONS.md
│   └── 08_sentiment_agent/                # 8단계: 센티먼트 분석
│       └── INSTRUCTIONS.md
├── data_sources/                          # 데이터 소스 가이드
│   ├── korea_market.md
│   ├── financial_data.md
│   └── alternative_data.md
├── models/                                # 밸류에이션 모델
│   ├── dcf_model.md
│   ├── relative_model.md
│   └── risk_model.md
├── templates/                             # 출력 템플릿
│   └── stock_report_template.md
└── output/                                # 분석 결과 저장
```

## 에이전트 아키텍처

```
                    ┌─────────────────────────────────┐
                    │     00_master_orchestrator      │
                    │   (전체 워크플로우 조율 및 통합)   │
                    └─────────────┬───────────────────┘
                                  │
          ┌───────────────────────┼───────────────────────┐
          │                       │                       │
          ▼                       ▼                       ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│  Phase 1: 발굴   │    │  Phase 2: 분석   │    │  Phase 3: 검증   │
└────────┬────────┘    └────────┬────────┘    └────────┬────────┘
         │                      │                      │
         ▼                      │                      │
┌─────────────────┐             │                      │
│ 01_screening    │             │                      │
│ (퀀트 스크리닝)  │             │                      │
│ 2000+ → 100종목 │             │                      │
└────────┬────────┘             │                      │
         │                      ▼                      │
         │         ┌─────────────────┐                 │
         │         │ 02_financial    │                 │
         │         │ (재무제표 분석)  │                 │
         │         └────────┬────────┘                 │
         │                  │                          │
         │         ┌────────┴────────┐                 │
         │         ▼                 ▼                 │
         │  ┌──────────────┐  ┌──────────────┐         │
         │  │03_industry   │  │04_dcf        │         │
         │  │(산업 분석)   │  │(DCF 밸류에이션)│         │
         │  └──────┬───────┘  └──────┬───────┘         │
         │         │                 │                 │
         │         └────────┬────────┘                 │
         │                  │                          │
         │         ┌────────┴────────┐                 │
         │         ▼                                   │
         │  ┌──────────────┐                           │
         │  │05_relative   │                           │
         │  │(상대가치 평가)│                           │
         │  └──────┬───────┘                           │
         │         │                                   ▼
         │         │                      ┌─────────────────┐
         │         │                      │ 06_technical    │
         │         │                      │ (기술적 분석)    │
         │         │                      └────────┬────────┘
         │         │                               │
         │         │                      ┌────────┴────────┐
         │         │                      ▼                 ▼
         │         │               ┌──────────────┐  ┌──────────────┐
         │         │               │07_risk       │  │08_sentiment  │
         │         │               │(리스크 분석) │  │(센티먼트)    │
         │         │               └──────┬───────┘  └──────┬───────┘
         │         │                      │                 │
         └─────────┴──────────────────────┴─────────────────┘
                                  │
                                  ▼
                    ┌─────────────────────────────────┐
                    │      Final Output               │
                    │  - 종목별 투자의견 (Buy/Hold/Sell)│
                    │  - 목표주가 및 업사이드           │
                    │  - 포트폴리오 비중 제안           │
                    └─────────────────────────────────┘
```

## 분석 프레임워크

### 1. 멀티팩터 스크리닝 (Factor Investing)

| Factor | 지표 | 설명 |
|--------|------|------|
| **Value** | PER, PBR, EV/EBITDA | 저평가 종목 발굴 |
| **Quality** | ROE, ROIC, 부채비율 | 우량 기업 필터 |
| **Momentum** | 12M 수익률, 이익수정 | 상승 추세 확인 |
| **Growth** | 매출/이익 성장률 | 성장성 평가 |
| **Size** | 시가총액 | 유동성 확보 |

### 2. 밸류에이션 프레임워크

```
┌─────────────────────────────────────────────────────────────┐
│                    Intrinsic Value 산출                     │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   DCF (40%)              Relative (40%)        DDM (20%)    │
│   ┌─────────┐            ┌─────────┐          ┌─────────┐  │
│   │ FCFF    │            │ PER     │          │ 배당할인 │  │
│   │ FCFE    │            │ PBR     │          │ 모델    │  │
│   │ WACC    │            │EV/EBITDA│          │         │  │
│   └────┬────┘            └────┬────┘          └────┬────┘  │
│        │                      │                    │        │
│        └──────────────────────┴────────────────────┘        │
│                              │                              │
│                              ▼                              │
│                    ┌─────────────────┐                      │
│                    │  Target Price   │                      │
│                    │  (목표주가)      │                      │
│                    └─────────────────┘                      │
└─────────────────────────────────────────────────────────────┘
```

### 3. 리스크 평가 매트릭스

| 리스크 유형 | 지표 | 임계값 |
|-------------|------|--------|
| 시장 리스크 | Beta, VaR | Beta < 1.5 |
| 유동성 리스크 | 거래대금, 회전율 | 일평균 10억 이상 |
| 신용 리스크 | 부채비율, 이자보상배율 | D/E < 200% |
| 변동성 리스크 | Historical Vol | Vol < 40% |

## 데이터 소스

### Primary (핵심 데이터)
- **KRX**: 한국거래소 공시 데이터
- **DART**: 전자공시시스템 재무제표
- **FnGuide**: 컨센서스 및 재무 데이터
- **네이버/다음 금융**: 실시간 시세

### Secondary (보조 데이터)
- **증권사 리포트**: NH, 삼성, 미래에셋 등
- **뉴스 API**: 네이버/다음 뉴스
- **해외 비교**: Bloomberg, Yahoo Finance

### Alternative (대안 데이터)
- **위성 이미지**: 공장 가동률
- **신용카드 결제**: 소비 트렌드
- **구인 공고**: 기업 성장 시그널

## 출력 형식

### 종목 리포트 (Stock Report)
```markdown
# [종목명] (종목코드) 투자의견: BUY

## Executive Summary
- 목표주가: 80,000원 (현재가 대비 +25%)
- 투자등급: BUY (신규)
- 핵심 투자포인트: ...

## 밸류에이션 Summary
| 방법론 | 적정가치 | 비중 |
|--------|----------|------|
| DCF | 85,000원 | 40% |
| PER | 78,000원 | 40% |
| DDM | 72,000원 | 20% |
| **가중평균** | **80,000원** | 100% |

## Risk Factors
1. ...
2. ...
```

## 실행 방법

### 전체 파이프라인 실행
```bash
# 1. 마스터 오케스트레이터 실행
cat agents/00_master_orchestrator/INSTRUCTIONS.md

# 2. 개별 에이전트 순차 실행
for agent in agents/0[1-8]*/; do
    echo "Running: $agent"
done
```

### 단일 종목 분석
```bash
# 특정 종목 딥다이브 분석
# 종목코드: 005930 (삼성전자)
cat agents/02_financial_agent/INSTRUCTIONS.md
```

## 라이선스

Internal Use Only
